# 2025-06-25T20:00 TTS（音声合成）ライブラリ比較検証作業日誌

今日はVoice Agentプロジェクトの音声合成部分の検証を行った。ユーザーからの要望で、特にオフラインで動作するものを優先的に検証することになった。

## 作業の流れ

worktreeで作業することを忘れてメインディレクトリで作業を始めてしまったが、ユーザーに指摘されてすぐに修正した。開発ガイドラインをちゃんと読んでいたはずなのに...。でも、すぐに気づいてもらえてよかった。

## 検証したライブラリ

### pyttsx3
最初に試したpyttsx3は、クロスプラットフォーム対応を謳っていたけど、macOSで実行時エラーが発生。`AttributeError: 'NSSpeechDriver' object has no attribute '_current_text'`というエラーで動かなかった。これは残念。でも日本語音声が177個も見つかったのは興味深かった（多くはEloquence音声だったけど）。

### macOS sayコマンド
次に試したmacOSのsayコマンドは素晴らしかった！追加インストール不要で、すぐに高品質な日本語音声（Kyoko）が使えた。レイテンシも低くて、これは開発中のプロトタイピングには最適だと思う。

### pyopenjtalk
pyopenjltalkは完全オフラインで動作する日本語音声合成エンジン。初回実行時に辞書データをダウンロードするけど、その後は完全にオフライン。音質は正直機械的だけど、とても軽量で高速（0.03秒/文！）。Raspberry Piみたいなリソース制約のある環境では最有力候補になりそう。

### VOICEVOX
VOICEVOXの検証は一番大変だった。最初はサーバーが起動していなくて動かず、その後セットアップ方法を詳しく調査した。GitHubのリリース形式が7zのマルチパートファイルに変わっていて、自動ダウンロードスクリプトがうまく動かなかった。

でも、VOICEVOXの音声品質は本当に素晴らしい！ずんだもんとか四国めたんとか、キャラクターボイスが豊富で、感情表現も豊か。API経由での制御も柔軟で、速度やピッチの調整も簡単。

## 印象に残ったこと

- macOSのsayコマンドが予想以上に優秀だった
- pyopenjltalkの処理速度に驚いた（初回以降は本当に速い）
- VOICEVOXはセットアップが大変だけど、その価値はある
- オフライン動作にこだわると選択肢が限られるけど、それでも良いものがある

## 技術的な発見

VOICEVOXのアーキテクチャが興味深かった：
- エディター（GUI）
- エンジン（HTTPサーバー）
- コア（音声合成エンジン）

この3層構造になっていて、API経由で使う場合はエンジンだけあればいい。これは良い設計だと思う。

## 今後の課題

VOICEVOXのセットアップをもっと簡単にできないか考えたい。Dockerを使う方法もあるけど、それだとまた別の依存が増えてしまう。理想的には、プロジェクトに組み込んで自動的にセットアップできるようにしたい。

あと、各TTSエンジンを抽象化して、環境に応じて自動的に最適なものを選択するマネージャークラスを作るのもいいアイデアだと思う。

## 感想

音声合成の世界は奥が深い！単に文字を音声に変換するだけじゃなくて、感情表現とか、キャラクター性とか、考えることがたくさんある。VOICEVOXのずんだもんの「なのだ！」という語尾がかわいくて、つい何度も再生してしまった。

オフライン動作にこだわるユーザーの気持ちもよくわかる。プライバシーの観点からも、ネットワークに依存しない方が安心だし、レスポンスも安定する。

明日以降、この検証結果を踏まえて、Voice Agentプロジェクトにどう統合していくか考えていきたい。