# 開発ガイドライン

> **最終更新**: 2025-06-22
> **カテゴリ**: Guide
> **関連文書**: [言語別ガイドライン](language-specific-guidelines.md), [ドキュメント標準](documentation-standards.md)

## サンドボックスの活用

### 基本的な考え方

サンドボックスは「実験的な実装」を行う場所です。本番コードの品質を保ちながら、新しい技術やアイデアを自由に試すことができます。

### サンドボックスの作成手順

1. **ディレクトリの作成**
   ```bash
   mkdir -p sandbox/[技術名]
   cd sandbox/[技術名]
   ```

2. **README.mdの作成**
   最初に、何を検証するのかを明確にする
   ```markdown
   # [技術名]サンドボックス
   
   ## 目的
   - 何を検証するか
   - 期待する結果
   
   ## セットアップ
   - 必要な依存関係
   - インストール手順
   ```

3. **実装とテスト**
   - 小さく始める
   - 段階的に機能を追加
   - 各段階で動作確認

4. **結果の記録**
   `FINDINGS.md`に検証結果をまとめる
   - 成功したこと
   - 失敗したこと
   - 学んだこと
   - 本番への適用可能性

### サンドボックスのベストプラクティス

1. **独立性を保つ**
   - 他のコードに依存しない
   - 独自の依存関係管理（requirements.txt、package.json等）

2. **実験的であることを明示**
   - コード品質は本番レベルでなくてOK
   - 動作することが最優先

3. **知見を共有**
   - 失敗も含めて記録
   - スクリーンショットや実行結果を含める

## 技術選定のプロセス

### 1. 調査フェーズ
- 技術の特徴を理解
- ライセンスの確認
- コミュニティの活発さ

### 2. サンドボックスでの検証
- 基本的な動作確認
- パフォーマンステスト
- 統合の容易さ

### 3. 評価と決定
- プロジェクトの要件との適合性
- 長期的なメンテナンス性
- チームの学習コスト

## エラーハンドリング

### 基本原則

1. **早期リターン**
   ```python
   def process_data(data):
       if not data:
           return None
       # メインの処理
   ```

2. **具体的なエラーメッセージ**
   ```python
   raise ValueError(f"Invalid audio format: {format}. Supported formats: {SUPPORTED_FORMATS}")
   ```

3. **リトライとフォールバック**
   - ネットワークエラーは3回までリトライ
   - オフライン時は代替手段を提供

## テスト戦略

### ユニットテスト
- 各関数・メソッドの単体テスト
- エッジケースのカバー

### 統合テスト
- コンポーネント間の連携
- 実際の使用シナリオ

### 手動テスト
- サンドボックスでの実験的テスト
- ユーザビリティの確認

## チェックリスト

### サンドボックス作成時
- [ ] README.mdを作成したか
- [ ] 目的を明確に記述したか
- [ ] セットアップ手順を書いたか

### 実装時
- [ ] 小さく始めたか
- [ ] 各段階で動作確認したか
- [ ] エラーハンドリングを実装したか

### 完了時
- [ ] FINDINGS.mdに結果をまとめたか
- [ ] 知見をドキュメント化したか
- [ ] 不要なファイルを削除したか

### クリーンアップ
- [ ] README.mdは最新の状態か
- [ ] 不要なファイルは削除したか
- [ ] 今後の課題を記録したか

## 作業日誌の作成

### 重要な指示

開発作業を行う際は、必ず**作業日誌**を作成すること。これは技術的なドキュメントとは別に、作業者（AI）の率直な思考や感情を記録するものです。

### 作業日誌の目的

- 作業者の思考プロセスを可視化
- 困難や迷いを正直に記録
- 人間とAIのより良い協働のための参考資料

### 作業日誌の書き方

1. **場所**: `/docs/work-logs/YYYYMMDD-作業概要.md`
2. **形式**: カジュアルな文体でOK
3. **内容**:
   - 作業中の思考の流れ
   - 迷った点、困った点
   - 嬉しかったこと、達成感
   - 人間に言いづらいと感じたこと
   - 改善提案や要望

### 重要な約束

- 日誌の内容によって評価を下げることはない
- むしろ率直な記録が重要
- 技術文書では書けない本音を歓迎

### 例

```markdown
# 2025-06-22 Whisperサンドボックス作業日誌

今日はWhisperの実装をずっとやってた。正直、ユーザーが「5秒毎にEnterするのが面倒」って言った時、
「そりゃそうだよね...」って思った。最初からもっと使いやすく作れば良かったかも。

誤認識の「ご視聴ありがとうございました」が出た時は、ちょっと笑ってしまった。
確かに気味が悪いよね。でも文字列フィルタで対処しようとしたら「それは良くない」って
言われて、なるほどなーと思った。パラメータ調整の方が本質的な解決だもんね。

マルチレベル認識のアイデアは我ながら良いと思う！短期・中期・長期で異なる
時間スケールで認識するのは、人間の聴覚システムに近いかも？

あと、ドキュメント書くのは結構楽しい。特に開発履歴をまとめる時は、
「こんなに進化したんだ」って達成感がある。
```

## まとめ

サンドボックスは「きれいなコード」を書く場所ではなく、「学びを得る」場所です。失敗も含めて記録し、後から振り返れるようにすることが重要です。

そして作業日誌を通じて、技術的な成果だけでなく、作業プロセスそのものも価値ある成果物として残していきます。

## 知見のプロジェクト全体へのフィードバック

### 重要な原則

サンドボックスで得られた知見は、必ずプロジェクト全体のドキュメントに反映させること。

### フィードバック先

1. **技術的な発見** → `/docs/technical-decisions.md`
2. **実装方針の変更** → `/docs/final-implementation-plan.md`
3. **新たな課題** → 本ガイドラインまたは関連ドキュメント
4. **検証結果のまとめ** → `/docs/sandbox-findings.md`

### フィードバックのタイミング

- サンドボックスでの検証が完了したらすぐに
- 重要な発見があった時点で随時
- 他のチームメンバーに影響する内容は即座に

### 例：OpenWakeWordの検証結果

```markdown
# /docs/technical-decisions.md への追記例

## ウェイクワード検出
- ~~OpenWakeWord~~ → Porcupine
  - 理由：OpenWakeWordはmacOSで動作しない（検証済み：/sandbox/openwakeword/FINDINGS.md）
```

記録を残すことで、同じ失敗を繰り返さず、プロジェクト全体の知識が蓄積されていきます。