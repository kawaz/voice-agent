# カスタムウェイクワード作成ガイド

> **最終更新**: 2025-06-22
> **カテゴリ**: Guide
> **関連文書**: [Porcupineセットアップガイド](porcupine-setup-guide.md)

## 概要

家族全員が使いやすいカスタムウェイクワードの作成方法と実装ガイドです。

## 推奨ウェイクワード

### 家族向けウェイクワード案

#### 1. シンプル＆親しみやすい
- **「ねえハウス」** - 最も推奨（短い、覚えやすい、子供も言いやすい）
- **「おっけーはうす」** - 子供向けの発音
- **「おーけーはうす」** - 大人向けの丁寧な発音

#### 2. 日本語の自然な呼びかけ
- **「おーい」** - 最も自然だが誤認識の可能性あり
- **「ちょっと」** - 日常的だが誤認識リスク高
- **「すみません」** - 丁寧で誤認識少ない

#### 3. オリジナルキャラクター系
- **「ねえピコ」** - Picovoiceから
- **「ハローホーム」** - 英語練習にも

## 作成手順

### Step 1: Picovoice Consoleにアクセス
1. [https://console.picovoice.ai/](https://console.picovoice.ai/)にログイン
2. 左メニューから「Wake Word」を選択

### Step 2: ウェイクワードのトレーニング
1. 「Train Wake Word」をクリック
2. 設定入力:
   ```
   Wake phrase: ねえハウス
   Language: Japanese (ja)
   Target Platform: [使用するプラットフォーム]
   ```
3. 「Train」をクリック（3-5分待つ）

### Step 3: ダウンロードと実装
1. 完成した`.ppn`ファイルをダウンロード
2. プロジェクトの`wake_words/`ディレクトリに配置

## 複数パターン戦略

### なぜ複数パターンが有効か

家族の発音の違いに対応:
- 子供: 「おっけーはうす」（言いやすい）
- 大人: 「おーけーはうす」（標準的）
- 急いでいる時: より短い発音も認識

### 実装例

```python
class MultiPatternWakeWord:
    def __init__(self):
        # 複数パターンを異なる感度で登録
        self.patterns = [
            ("wake_words/おっけーはうす.ppn", 0.5),  # メイン
            ("wake_words/おーけーはうす.ppn", 0.4),  # サブ
        ]
        
        self.porcupine = pvporcupine.create(
            access_key=access_key,
            keyword_paths=[p[0] for p in self.patterns],
            sensitivities=[p[1] for p in self.patterns]
        )
```

## 感度調整のコツ

### 基本指針
- **標準（0.5）**: バランスの取れた設定
- **高感度（0.6-0.8）**: 認識しやすいが誤検出も増える
- **低感度（0.3-0.4）**: 誤検出は少ないが認識しにくい

### パターン別推奨設定
```python
sensitivities = {
    "メインパターン": 0.5,      # 最もよく使う
    "類似パターン": 0.4,        # 誤認識防止でやや低め
    "短いパターン": 0.3,        # 短い単語は低めに
    "長いパターン": 0.6         # 長い単語は高めに
}
```

## テストと調整

### 家族全員でのテスト手順

1. **個別テスト**
   ```bash
   # 各パターンを単独でテスト
   python test_wake_word.py --pattern "おっけーはうす" --sensitivity 0.5
   ```

2. **統合テスト**
   - 全パターンを同時に登録
   - 各家族メンバーが10回ずつ試す
   - 認識率を記録

3. **感度調整**
   - 認識率が低い → 感度を0.1上げる
   - 誤検出が多い → 感度を0.1下げる

### テストスクリプト例

```python
def test_family_wake_words():
    """家族向けウェイクワードのテスト"""
    
    # テスト結果を記録
    results = {
        "パパ": {"成功": 0, "失敗": 0},
        "ママ": {"成功": 0, "失敗": 0},
        "子供": {"成功": 0, "失敗": 0},
    }
    
    print("各メンバーが10回ずつウェイクワードを言ってください")
    
    # テスト実行...
    
    # 結果分析
    for member, stats in results.items():
        success_rate = stats["成功"] / (stats["成功"] + stats["失敗"]) * 100
        print(f"{member}: {success_rate:.1f}%")
```

## トラブルシューティング

### よくある問題と対策

1. **子供の声が認識されない**
   - 感度を0.6-0.7に上げる
   - よりシンプルな発音のパターンを追加

2. **テレビの音で誤認識**
   - 感度を0.3-0.4に下げる
   - より独特なフレーズに変更

3. **家族によって認識率が違う**
   - 複数パターンを用意
   - 各パターンの感度を個別調整

## まとめ

推奨構成:
1. メインウェイクワード: 「おっけーはうす」（感度0.5）
2. サブウェイクワード: 「おーけーはうす」（感度0.4）
3. 必要に応じて3つ目を追加

この構成で家族全員が自然に使える音声アシスタントを実現できます。