# サンドボックス検証結果まとめ

> **最終更新**: 2025-06-22
> **カテゴリ**: Research
> **関連文書**: [開発ガイドライン](development-guidelines.md), [技術決定事項](technical-decisions.md)

## 概要

このドキュメントは、各サンドボックスで得られた検証結果と知見をまとめたものです。詳細は各サンドボックスの`FINDINGS.md`を参照してください。

## 検証済みサンドボックス

### 1. OpenWakeWord（2025年6月22日）

**結論**: macOS環境では動作不可

**主な発見**:
- ONNXモデルは正常にロード可能
- 音声検出は正常に動作
- **推論時にSIGSEGVでクラッシュ**（C++レベルのバグ）
- PyTorchバックエンドも同様のエラー

**代替案**: Porcupineへの移行を決定

### 2. Whisper音声認識（2025年6月22日）

**結論**: 実用レベルで動作、マルチレベル認識で高精度化

**主な発見**:
- smallモデルで日本語認識は実用的
- 処理速度: 2-8倍速（音声長依存）
- 音声検出閾値: RMS 200-250が最適
- 誤認識パターン:
  - 固有名詞（Eテレ→いいテレイ）
  - 数字（3→さん）
  - 無音時の定型句

**推奨実装**:
- マルチレベル認識（3秒/8秒/20秒/無音区切り）
- オーバーラップ処理必須
- マルチプロセスで並列処理

## 技術選定への影響

### ウェイクワード検出
- ❌ OpenWakeWord: macOS非対応
- ✅ Porcupine: 採用決定

### 音声認識
- ✅ Whisper: オフライン動作で採用
- 🔄 Web Speech API: オンライン時のバックアップ

### アーキテクチャ
- マルチプロセス処理の有効性を確認
- リングバッファによるメモリ効率化
- 段階的な認識精度向上手法の確立

### 3. Porcupine（2025年6月22日）

**結論**: 完全にローカルで動作、実用レベルの性能

**主な発見**:
- 完全オフライン動作を確認（APIキーは初回認証のみ）
- CPU使用率: わずか2.4%（M1 Mac実測）
- メモリ使用量: 32.5MB
- 検出精度: 97%以上（公称値通り）
- セットアップ時間: 約15分
- APIキー設定後の実動作確認成功

**特筆事項**:
- macOSで問題なく動作（OpenWakeWordは動作不可）
- 日本語カスタムウェイクワード作成可能
- 複数ウェイクワード同時対応
- 商用利用可能（3ユーザーまで無料）
- カスタムウェイクワード「おっけーはうす」を推奨

## 今後の検証予定

1. **統合テスト**
   - Porcupine → Whisper連携の実装
   - レスポンス時間の最適化
   - エラーハンドリング

2. **Raspberry Pi環境**
   - 動作確認
   - パフォーマンス測定
   - 最適化

3. **カスタムウェイクワード**
   - 日本語ウェイクワードの作成と検証
   - 複数パターンの最適化

## 教訓

1. **段階的な実装**
   - 小さく始めて徐々に機能追加
   - 各段階で動作確認

2. **実測値の重要性**
   - 理論値より実際の動作確認
   - ユーザーフィードバックの即座反映

3. **ドキュメント化**
   - 開発過程の詳細記録
   - 失敗も含めて知見として保存

## 関連ドキュメント

- [Whisper開発履歴](/sandbox/whisper/DEVELOPMENT_HISTORY.md)
- [Whisper検証結果](/sandbox/whisper/FINDINGS.md)
- [OpenWakeWord検証結果](/sandbox/openwakeword/FINDINGS.md)
- [Porcupine検証結果](/sandbox/porcupine/FINDINGS.md)